% particles:10,000,000 = 10m
% strikes:50

%naive
e1 = [0.9982 1.0020 0.9934 1.0046 1.0010 0.9984 0.9945 1.0047 1.0004 1.0032 0.9934 0.9962 0.9938 1.0005 1.0007 0.9834 0.9988 0.9926 1.0062 0.9968 0.9959 1.0057 1.0113 0.9976 0.9975 1.0120 0.9951 1.0046 0.9910 1.0061 0.9967 0.9991 0.9918 1.0074 1.0082 0.9974 0.9998 1.0012 1.0119 0.9978 1.0065 0.9956 1.0038 0.9899 1.0030 1.0035 0.9986 1.0053 0.9972 0.9997 ];
s1 = [0.0492 0.1017 0.1209 0.1365 0.1502 0.1628 0.1748 0.1863 0.1974 0.2083 0.2190 0.2297 0.2403 0.2510 0.2617 0.2725 0.2834 0.2945 0.3057 0.3172 0.3289 0.3410 0.3533 0.3660 0.3791 0.3926 0.4067 0.4213 0.4365 0.4524 0.4690 0.4865 0.5050 0.5246 0.5455 0.5677 0.5916 0.6174 0.6454 0.6760 0.7100 0.7479 0.7909 0.8404 0.8988 0.9694 1.0588 1.1794 1.3627 1.7475 ];

%gauss
e2 = [0.9990 0.9980 0.9982 1.0009 1.0015 0.9998 0.9992 1.0002 1.0009 0.9997 0.9970 0.9954 0.9959 0.9972 0.9964 0.9941 0.9951 0.9978 0.9990 0.9985 0.9992 1.0031 1.0053 1.0024 1.0011 1.0028 1.0022 0.9996 0.9984 0.9998 0.9993 0.9982 0.9992 1.0021 1.0029 1.0010 1.0008 1.0022 1.0044 1.0046 1.0031 1.0011 0.9983 0.9967 0.9991 1.0007 1.0010 1.0020 1.0012 1.0003 ];
s2 = [0.0492 0.1017 0.1209 0.1365 0.1502 0.1628 0.1748 0.1863 0.1974 0.2083 0.2190 0.2297 0.2403 0.2510 0.2617 0.2725 0.2834 0.2945 0.3057 0.3172 0.3289 0.3410 0.3533 0.3660 0.3791 0.3926 0.4067 0.4213 0.4365 0.4524 0.4690 0.4865 0.5050 0.5246 0.5455 0.5677 0.5916 0.6174 0.6454 0.6760 0.7100 0.7479 0.7909 0.8404 0.8988 0.9694 1.0588 1.1794 1.3627 1.7475 ];

%hat
eh = [0.9960 0.9986 1.0064 0.9998 1.0025 1.0067 1.0073 0.9936 1.0044 1.0079 1.0120 0.9978 1.0131 0.9997 0.9959 1.0062 1.0097 1.0050 1.0045 1.0029 0.9956 0.9975 0.9937 0.9922 0.9981 0.9974 1.0055 1.0061 0.9948 0.9907 0.9985 1.0106 1.0007 0.9974 1.0085 0.9927 0.9943 0.9910 0.9996 0.9859 1.0019 0.9992 0.9988 0.9892 0.9971 0.9894 1.0035 1.0041 1.0072 1.0056 ];
sh = [0.0503 0.1017 0.1209 0.1365 0.1503 0.1629 0.1749 0.1863 0.1974 0.2083 0.2191 0.2297 0.2404 0.2511 0.2618 0.2726 0.2835 0.2946 0.3059 0.3174 0.3291 0.3411 0.3535 0.3662 0.3793 0.3929 0.4070 0.4216 0.4368 0.4526 0.4692 0.4867 0.5052 0.5247 0.5455 0.5677 0.5916 0.6173 0.6452 0.6758 0.7098 0.7477 0.7907 0.8404 0.8989 0.9696 1.0587 1.1793 1.3628 1.7472 ];

%epan
e3 = [1.0006 0.9991 0.9979 1.0019 1.0017 0.9996 1.0015 0.9990 0.9989 0.9998 0.9991 1.0003 0.9993 1.0016 0.9998 1.0007 0.9998 0.9990 0.9982 0.9976 0.9997 0.9995 0.9996 1.0009 0.9991 0.9996 1.0001 0.9997 1.0014 1.0001 0.9978 0.9968 1.0013 1.0015 1.0005 0.9989 0.9994 0.9994 0.9985 0.9957 0.9976 1.0001 1.0005 0.9995 1.0002 0.9995 1.0001 0.9986 1.0005 1.0005 ];
s3 = [0.0477 0.1017 0.1209 0.1364 0.1502 0.1628 0.1748 0.1862 0.1974 0.2083 0.2190 0.2297 0.2403 0.2510 0.2617 0.2725 0.2835 0.2946 0.3058 0.3173 0.3291 0.3411 0.3535 0.3662 0.3793 0.3928 0.4069 0.4215 0.4367 0.4526 0.4692 0.4867 0.5052 0.5247 0.5455 0.5677 0.5916 0.6173 0.6453 0.6760 0.7099 0.7479 0.7908 0.8403 0.8986 0.9693 1.0586 1.1790 1.3622 1.7462 ];


%plot(s2, e2, s3, e3)
%legend('gauss', 'epan')

plot(s1, e1, s2, e2, sh, eh, s3, e3)

legend('naive', 'gauss', 'hat', 'epan')
title('1 Timestep, InitPrice = 0.5, NumPart = 10m, Strikes = 50')