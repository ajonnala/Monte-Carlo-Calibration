% hat kernel
% 50 strikes
% 5 time steps
% initial price = 0.6

e1 = [0.3941 0.3941 0.3941 0.3941 0.3941 0.3941 0.3941 0.3941 0.3941 0.3941 0.3941 0.3941 0.3941 0.3941 0.3941 0.3941 0.3941 0.3941 0.3941 0.3941 0.3941 0.3941 0.3941 0.3941 0.3941 0.3941 0.3941 0.3942 0.3943 0.3925 0.3938 0.3939 0.3940 0.3940 0.3940 0.3940 0.3940 0.3940 0.3940 0.3940 0.3940 0.3940 0.3940 0.3940 0.3940 0.3940 0.3940 0.3940 0.3940 0.3940 ];
s1 = [0.1441 0.2540 0.2808 0.3012 0.3184 0.3337 0.3476 0.3606 0.3728 0.3846 0.3960 0.4070 0.4178 0.4284 0.4389 0.4492 0.4596 0.4699 0.4802 0.4905 0.5009 0.5114 0.5220 0.5328 0.5437 0.5549 0.5662 0.5779 0.5898 0.6021 0.6148 0.6279 0.6416 0.6558 0.6707 0.6863 0.7028 0.7203 0.7389 0.7590 0.7808 0.8046 0.8310 0.8606 0.8946 0.9345 0.9833 1.0463 1.1367 1.3091 ];

e2 = [0.2898 0.2876 0.2875 0.2874 0.2874 0.2873 0.2873 0.2873 0.2873 0.2873 0.2873 0.2873 0.2873 0.2873 0.2873 0.2873 0.2873 0.2873 0.2873 0.2873 0.2873 0.2873 0.2872 0.2872 0.2872 0.2872 0.2872 0.2872 0.2871 0.2870 0.2862 0.2880 0.2875 0.2875 0.2874 0.2874 0.2874 0.2874 0.2873 0.2873 0.2873 0.2873 0.2873 0.2873 0.2873 0.2873 0.2872 0.2872 0.2870 0.2864 ];
s2 = [0.0719 0.1617 0.1925 0.2159 0.2356 0.2530 0.2691 0.2841 0.2984 0.3121 0.3253 0.3383 0.3510 0.3636 0.3760 0.3884 0.4008 0.4132 0.4256 0.4382 0.4509 0.4637 0.4768 0.4901 0.5037 0.5177 0.5320 0.5467 0.5619 0.5777 0.5941 0.6111 0.6289 0.6476 0.6673 0.6882 0.7104 0.7342 0.7599 0.7877 0.8183 0.8522 0.8903 0.9338 0.9846 1.0456 1.1221 1.2247 1.3804 1.7127 ];

e3 = [0.2980 0.2955 0.2952 0.2951 0.2950 0.2950 0.2950 0.2950 0.2950 0.2950 0.2950 0.2950 0.2950 0.2951 0.2951 0.2951 0.2951 0.2951 0.2952 0.2952 0.2953 0.2953 0.2954 0.2954 0.2955 0.2956 0.2958 0.2960 0.2964 0.2971 0.2987 0.3073 0.2845 0.2912 0.2926 0.2932 0.2936 0.2938 0.2940 0.2941 0.2942 0.2942 0.2943 0.2943 0.2944 0.2944 0.2944 0.2944 0.2942 0.2932 ];
s3 = [0.0442 0.1065 0.1377 0.1620 0.1827 0.2011 0.2182 0.2341 0.2493 0.2639 0.2781 0.2920 0.3056 0.3191 0.3325 0.3458 0.3592 0.3726 0.3862 0.3999 0.4137 0.4278 0.4421 0.4568 0.4718 0.4872 0.5031 0.5194 0.5364 0.5540 0.5724 0.5916 0.6118 0.6330 0.6555 0.6794 0.7050 0.7325 0.7624 0.7951 0.8312 0.8715 0.9172 0.9700 1.0323 1.1083 1.2054 1.3388 1.5489 2.0331 ];

e4 = [0.3612 0.3584 0.3579 0.3577 0.3575 0.3573 0.3572 0.3571 0.3570 0.3569 0.3568 0.3566 0.3565 0.3564 0.3562 0.3561 0.3559 0.3557 0.3555 0.3553 0.3550 0.3547 0.3543 0.3538 0.3532 0.3525 0.3516 0.3503 0.3484 0.3453 0.3397 0.3252 0.2090 0.4177 0.3830 0.3739 0.3696 0.3672 0.3656 0.3644 0.3636 0.3629 0.3624 0.3619 0.3615 0.3612 0.3609 0.3605 0.3600 0.3582 ];
s4 = [0.0274 0.0711 0.1002 0.1238 0.1444 0.1630 0.1803 0.1966 0.2122 0.2272 0.2419 0.2562 0.2704 0.2844 0.2983 0.3122 0.3262 0.3402 0.3544 0.3687 0.3833 0.3981 0.4132 0.4286 0.4445 0.4608 0.4777 0.4951 0.5132 0.5321 0.5518 0.5724 0.5941 0.6171 0.6414 0.6674 0.6953 0.7254 0.7582 0.7942 0.8342 0.8791 0.9303 0.9898 1.0607 1.1482 1.2613 1.4194 1.6745 2.2933 ];

e5 = [0.4693 0.4664 0.4656 0.4652 0.4648 0.4644 0.4641 0.4638 0.4635 0.4631 0.4628 0.4624 0.4620 0.4616 0.4612 0.4607 0.4602 0.4597 0.4590 0.4583 0.4575 0.4565 0.4554 0.4541 0.4525 0.4505 0.4480 0.4447 0.4400 0.4330 0.4212 0.3975 0.3243 3.7090 0.5994 0.5348 0.5126 0.5014 0.4945 0.4899 0.4865 0.4840 0.4820 0.4803 0.4789 0.4777 0.4766 0.4755 0.4742 0.4713 ];
s5 = [0.0170 0.0480 0.0735 0.0954 0.1151 0.1333 0.1503 0.1665 0.1821 0.1972 0.2120 0.2265 0.2409 0.2551 0.2694 0.2836 0.2978 0.3122 0.3267 0.3415 0.3564 0.3717 0.3873 0.4033 0.4197 0.4366 0.4542 0.4724 0.4913 0.5111 0.5319 0.5537 0.5769 0.6013 0.6273 0.6549 0.6846 0.7166 0.7516 0.7901 0.8330 0.8814 0.9369 1.0018 1.0796 1.1762 1.3024 1.4809 1.7742 2.5119 ];

plot(s1, e1, s2, e2, s3, e3, s4, e4, s5, e5);
legend ('T1', 'T2', 'T3', 'T4', 'T5')
title('Hat Kernel, Particles = 10m, Strikes = 50, 5 timesteps')